var custom=new function(){var e=this;e.request=null,e.confirm=function(e,t,a,n){var o;return o=(0,templates["modal/confirm"])($.extend({},!0,{confirm_button:"OK",cancel_button:"Cancel",width:"600px"},n,{title:e,confirm_message:t})),$(window.document.body).append(o),$("#confirmModal").modal({}),$("#confirmModal").on("hidden.bs.modal",function(e){$("#confirmModal").remove()}),$("#confirm_yes").on("click",function(e){return $("#confirm_yes").unbind("click"),$("#confirmModal").modal("hide"),a.call()})},e.ajax=function(t){var a=$.extend({},!0,t);"object"==typeof t&&(t.beforeSend=function(){"function"==typeof a.beforeSend&&a.beforeSend()},t.success=function(e){if(e.redirect&&e.redirect.length>0)return void window.location.replace(e.redirect);"function"==typeof a.success&&a.success(e)},null!=e.request&&e.request.abort(),e.request=$.ajax(t))},e.notify=function(e){var t,a,n=$("body");if(n.addClass("bottom-right"),"object"!=typeof e)return!1;for(t in e)a=$.extend({},!0,{type:"success",delay:8e3,text:""},e[t]),void 0!==a.text&&null!=a.text&&$.notify({message:a.text.toString()},{type:a.type,placement:{from:"bottom",align:"right"},z_index:2e3,delay:a.delay,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})},e.sendBtn=function(t,a){if("object"!=typeof a&&(a={}),!t.hasClass("active")){t.addClass("has-spinner");var n=$.extend({},!0,a);if(n.url=t.attr("href")||t.data("url"),void 0!==n.type&&n.type.toUpperCase()==="POST".toUpperCase()&&yii){var o={};o[yii.getCsrfParam()]=yii.getCsrfToken(),n.data=$.extend({},n.data,o)}$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),n.beforeSend=function(){t.addClass("active")},n.success=function(n){t.removeClass("active"),$(".spinner",t).remove(),"success"===n.status?"function"==typeof a.callback&&a.callback(n):"error"===n.status&&e.notify({0:{type:"danger",text:n.message}})},e.ajax(n)}},e.sendFrom=function(t,a,n){if("object"!=typeof n&&(n={}),!t.hasClass("active")){t.addClass("has-spinner");var o=$.extend({},!0,n),i=$(".error-summary",a);o.url=a.attr("action"),o.type="POST",$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),o.beforeSend=function(){t.addClass("active"),custom.showModalLoader(!0),i.length&&(i.addClass("hidden"),i.html(""))},o.success=function(o){t.removeClass("active"),custom.showModalLoader(!1),$(".spinner",t).remove(),"success"==o.status?"function"==typeof n.callback&&n.callback(o):"error"==o.status&&(o.message&&(i.length?(i.html(o.message),i.removeClass("hidden")):e.notify({0:{type:"danger",text:o.message}})),o.errors&&$.each(o.errors,function(e,t){a.yiiActiveForm("updateAttribute",e,t)}),"function"==typeof n.errorCallback&&n.errorCallback(o))},e.ajax(o)}},e.generatePassword=function(e){void 0===e&&(e=8);var t,a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",o=a.length;for(t=0;t<e;++t)n+=a.charAt(Math.floor(Math.random()*o));return n},e.freezeForm=function(e){var t,a,n={};return e.find("input, select, textarea").each(function(){this.name&&(t=this.name,a=$(this),"checkbox"===a.attr("type")||"radio"===a.attr("type")?n[t]=a.prop("checked"):n[t]=a.val())}),JSON.stringify(n)},e.restoreForm=function(e,t){var a,n,o=JSON.parse(e);t.find("input, select, textarea").each(function(){this.name&&(a=this.name,n=$(this),"hidden"!==n.attr("type")&&("checkbox"===n.attr("type")||"radio"===n.attr("type")?n.prop("checked",o[a]):n.val(o[a])))})},e.showModalLoader=function(e){$(".modal-loader").toggleClass("hidden",!e)}},customModule={};window.modules={},$(function(){"object"==typeof window.modules&&$.each(window.modules,function(e,t){void 0!==customModule[e]&&customModule[e].run(t)})});var templates={};templates["addfunds/description"]=_.template('<div class="form-group fields" id="order_<%= name %>">\n    <label class="control-label" for="field-<%= name %>"><%= label %></label>\n    <div class="panel-body border-solid border-rounded text-center"><%= value %></div>\n</div>'),templates["addfunds/hidden"]=_.template('<input class="fields" name="AddFoundsForm[fields][<%= name %>]" value="<%= value %>" type="hidden" id="field-<%= name %>"/>'),templates["addfunds/input"]=_.template('<div class="form-group fields" id="order_<%= name %>">\n    <label class="control-label" for="field-<%= name %>"><%= label %></label>\n    <input class="form-control" name="AddFoundsForm[fields][<%= name %>]" value="<%= value %>" type="text" id="field-<%= name %>"/>\n</div>'),templates["addfunds/stripe_payment_request_btn"]=_.template('<span id="<%= id %>" style="width: 150px; height: 18px; display: inline-block;" class="hidden"></span>'),templates["admin/payment_settings_checkbox"]=_.template('<div class="form-check">\n    <input type="checkbox" class="form-check-input" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>]" id="edit-payment-method-options-<%= data[\'code\'] %>" value="1" <% if (data[\'value\']) { %> checked<% } %>>\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="form-check-label"><%= data[\'label\'] %></label>\n</div>'),templates["admin/payment_settings_course"]=_.template('<div class="form-group">\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="control-label"><%= data[\'label\'] %></label>\n    <input type="text" class="form-control" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>]" id="edit-payment-method-options-<%= data[\'code\'] %>" value="<%= data[\'value\'] %>">\n</div>'),templates["admin/payment_settings_input"]=_.template('<div class="form-group">\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="control-label"><%= data[\'label\'] %></label>\n    <input type="text" class="form-control" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>]" id="edit-payment-method-options-<%= data[\'code\'] %>" value="<%= data[\'value\'] %>">\n</div>'),templates["admin/payment_settings_multi_input"]=_.template('<div class="form-group form-group__paypal-description">\n    <span class="fa fa-times remove__paypal-description"></span>\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="control-label"><%= data[\'label\'] %></label>\n    <input type="text" class="form-control" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>][]" id="edit-payment-method-options-<%= data[\'code\'] %>" value="<%= value %>">\n</div>'),templates["admin/payment_settings_multi_input_container"]=_.template('<div id="multi_input_container_<%= data[\'code\'] %>">\n    <%= content %>\n</div>\n<a href="#" class="add-multi-input" data-id="#multi_input_container_<%= data[\'code\'] %>" data-code="<%= data[\'code\'] %>" data-name="<%= data[\'name\'] %>" data-label="<%= data[\'label\'] %>"><span><%= data[\'add_label\'] %></span></a>'),templates["admin/payment_settings_select"]=_.template('<div class="form-group">\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="control-label"><%= data[\'label\'] %></label>\n    <select class="form-control" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>]" id="edit-payment-method-options-<%= data[\'code\'] %>">\n        <% _.forEach(data[\'options\'], function(label, value) {%>\n        <option value="<%= value %>" <% if (value == data[\'value\']) { %> selected <% } %>><%= label %></option>\n        <%}); %>\n    </select>\n</div>'),templates["admin/payment_settings_textarea"]=_.template('<div class="form-group">\n    <label for="edit-payment-method-options-<%= data[\'code\'] %>" class="control-label"><%= data[\'label\'] %></label>\n    <textarea cols="30" rows="10" class="form-control" name="EditPaymentMethodForm[options][<%= data[\'name\'] %>]" id="edit-payment-method-options-<%= data[\'code\'] %>"><%= data[\'value\'] %></textarea>\n</div>'),templates["modal/confirm"]=_.template('<div class="modal fade confirm-modal" id="confirmModal" aria-labelledby="myModalLabel" tabindex="-1" data-backdrop="static">\n    <div class="modal-dialog modal-sm modal-yesno" role="document">\n        <div class="modal-content">\n            <% if (typeof(confirm_message) !== "undefined" && confirm_message != \'\') { %>\n            <div class="modal-body text-center">\n                <h5 class="mb-0"><%= title %></h5>\n            </div>\n\n            <div class="modal-body">\n                <p><%= confirm_message %></p>\n            </div>\n\n            <div class="modal-footer modal-footer__padding-10 justify-content-center">\n                <button class="btn btn-light" data-dismiss="modal" aria-hidden="true"><%= cancel_button %></button>\n                <button class="btn btn-primary" id="confirm_yes"><%= confirm_button %></button>\n            </div>\n            <% } else { %>\n\n            <div class="modal-body">\n                <div class="m-b" align="center">\n                    <h4 class="m-t-0"> <%= title %></h4>\n                </div>\n\n                <div align="center">\n                    <button type="submit" class="btn btn-primary" id="confirm_yes">\n                        <%= confirm_button %>\n                    </button>\n                    <button type="button" class="btn btn-default" data-dismiss="modal">\n                        <%= cancel_button %>\n                    </button>\n                </div>\n            </div>\n            <% } %>\n        </div>\n    </div>\n</div>'),templates["neworder/order_comment"]=_.template('<div class="form-group hidden fields" id="order_comment">\n    <label class="control-label" for="field-orderform-fields-comment"><%= label[\'comments\'] %></label>\n    <textarea class="form-control" name="OrderForm[comment]" id="field-orderform-fields-comment" cols="30" rows="10"><%= data[\'comment\'] %></textarea>\n</div>'),templates["neworder/order_comment_username"]=_.template('<div class="form-group hidden fields" id="order_comment_username">\n    <label class="control-label" for="field-orderform-fields-comment_username"><%= label[\'comment_username\'] %></label>\n    <input class="form-control" name="OrderForm[comment_username]" value="<%= data[\'username\'] %>" type="text" id="field-orderform-fields-comment_username"/>\n</div>'),templates["neworder/order_delay"]=_.template('<div class="form-group hidden fields" id="order_delay">\n    <div class="row">\n        <div class="col-xs-6">\n            <label class="control-label" for="field-orderform-fields-delay"><%= label[\'delay\'] %></label>\n            <select class="form-control" name="OrderForm[delay]" id="field-orderform-fields-delay">\n                <% _.forEach(delays, function(delayLabel, delayValue) {%>\n                <option value="<%= delayValue %>" <% if (delayValue == data[\'delay\']) { %> selected <% } %>><%= delayLabel %></option>\n                <%}); %>\n            </select>\n        </div>\n        <div class="col-xs-6">\n            <label for="field-orderform-fields-expiry"><%= label[\'expiry\'] %></label>\n            <div class="input-group">\n                <input class="form-control datetime" name="OrderForm[expiry]" value="<%= data[\'expiry\'] %>" type="text" id="field-orderform-fields-expiry"/>\n                <span class="input-group-btn">\n                    <button class="btn btn-default clear-datetime" type="button" data-rel="#field-orderform-fields-expiry"><span class="fa fa-trash-o"></span></button>\n                </span>\n            </div>\n        </div>\n    </div>\n</div>'),templates["neworder/order_dripfeed"]=_.template('<div id="dripfeed">\n    <div class="form-group fields hidden" id="order_check">\n        <label class="control-label has-depends " for="field-orderform-fields-check">\n            <input name="OrderForm[check]" value="1" type="checkbox" id="field-orderform-fields-check" <% if (data[\'check\']) { %> checked <% } %> />\n            <%= label[\'dripfeed\'] %>\n        </label>\n        <div class="hidden depend-fields" id="dripfeed-options" data-depend="field-orderform-fields-check">\n            <div class="form-group">\n                <label class="control-label" for="field-orderform-fields-runs"><%= label[\'dripfeed.runs\'] %></label>\n                <input class="form-control" name="OrderForm[runs]" value="<%= data[\'runs\'] %>" type="text" id="field-orderform-fields-runs" />\n            </div>\n\n            <div class="form-group">\n                <label class="control-label" for="field-orderform-fields-interval"><%= label[\'dripfeed.interval\'] %></label>\n                <input class="form-control" name="OrderForm[interval]" value="<%= data[\'interval\'] %>" type="text" id="field-orderform-fields-interval" />\n            </div>\n\n            <div class="form-group">\n                <label class="control-label" for="field-orderform-fields-total-quantity"><%= label[\'dripfeed.total.quantity\'] %></label>\n                <input class="form-control" name="OrderForm[total_quantity]" value="<%= data[\'total_quantity\'] %>" type="text" id="field-orderform-fields-total-quantity" readonly=""/>\n            </div>\n        </div>\n    </div>\n</div>'),templates["neworder/order_hashtag"]=_.template('<div class="form-group hidden fields" id="order_hashtag">\n    <label class="control-label" for="field-orderform-fields-hashtag"><%= label[\'hashtag\'] %></label>\n    <input class="form-control" name="OrderForm[hashtag]" value="<%= data[\'hashtag\'] %>" type="text" id="field-orderform-fields-hashtag"/>\n</div>'),templates["neworder/order_hashtags"]=_.template('<div class="form-group hidden fields" id="order_hashtags">\n    <label class="control-label" for="field-orderform-fields-hashtags"><%= label[\'hashtags\'] %></label>\n    <textarea class="form-control" name="OrderForm[hashtags]" id="field-orderform-fields-hashtags" cols="30" rows="10"><%= data[\'hashtags\'] %></textarea>\n</div>'),templates["neworder/order_keywords"]=_.template('<div class="form-group hidden fields" id="order_keywords">\n    <label class="control-label" for="field-orderform-fields-keywords"><%= label[\'keywords\'] %></label>\n    <textarea class="form-control" name="OrderForm[keywords]" id="field-orderform-fields-keywords" cols="30" rows="10"><%= data[\'keywords\'] %></textarea>\n</div>'),templates["neworder/order_link"]=_.template('<div class="form-group hidden fields" id="order_link">\n    <label class="control-label" for="field-orderform-fields-link"><%= label[\'link\'] %></label>\n    <input class="form-control" name="OrderForm[link]" value="<%= data[\'link\'] %>" type="text" id="field-orderform-fields-link"/>\n</div>'),templates["neworder/order_media_url"]=_.template('<div class="form-group hidden fields" id="order_mediaUrl">\n    <label class="control-label" for="field-orderform-fields-mediaUrl"><%= label[\'mediaurl\'] %></label>\n    <input class="form-control" name="OrderForm[mediaUrl]" value="<%= data[\'mediaUrl\'] %>" type="text" id="field-orderform-fields-mediaUrl"/>\n</div>'),templates["neworder/order_mention_usernames"]=_.template('<div class="form-group hidden fields" id="order_mentionUsernames">\n    <label class="control-label" for="field-orderform-fields-mentionUsernames"><%= label[\'usernames\'] %></label>\n    <textarea class="form-control" name="OrderForm[mentionUsernames]" id="field-orderform-fields-mentionUsernames" cols="30" rows="10"><%= data[\'mentionUsernames\'] %></textarea>\n</div>'),templates["neworder/order_min"]=_.template('<div class="form-group hidden fields" id="order_min">\n    <label class="control-label" for="order_count"><%= label[\'quantity\'] %></label>\n    <div class="row">\n        <div class="col-xs-6">\n            <input type="text" class="form-control" id="order_count" name="OrderForm[min]" value="<%= data[\'min\'] %>" placeholder="<%= label[\'min\'] %>" />\n        </div>\n\n        <div class="col-xs-6">\n            <input type="text" class="form-control" id="order_count" name="OrderForm[max]" value="<%= data[\'max\'] %>" placeholder="<%= label[\'max\'] %>" />\n        </div>\n    </div>\n</div>'),templates["neworder/order_posts"]=_.template('<div class="form-group hidden fields" id="order_posts">\n    <label class="control-label" for="field-orderform-fields-posts"><%= label[\'new_posts\'] %></label>\n    <input class="form-control" name="OrderForm[posts]" value="<%= data[\'posts\'] %>" type="text" id="field-orderform-fields-posts"/>\n</div>'),templates["neworder/order_quantity"]=_.template('<div class="form-group hidden fields" id="order_quantity">\n    <label class="control-label" for="field-orderform-fields-quantity"><%= label[\'quantity\'] %></label>\n    <input class="form-control" name="OrderForm[quantity]" value="<%= data[\'quantity\'] %>" type="text" id="field-orderform-fields-quantity"/>\n</div>'),templates["neworder/order_user_name"]=_.template('<div class="form-group hidden fields" id="order_user_name">\n    <label class="control-label" for="field-orderform-fields-user_name"><%= label[\'username\'] %></label>\n    <input class="form-control w-full" name="OrderForm[user_name]" value="<%= data[\'user_name\'] %>" type="text" id="field-orderform-fields-user_name"/>\n</div>'),templates["neworder/order_username"]=_.template('<div class="form-group hidden fields" id="order_username">\n    <label class="control-label" for="field-orderform-fields-username"><%= label[\'username\'] %></label>\n    <input class="form-control" name="OrderForm[username]" value="<%= data[\'username\'] %>" type="text" id="field-orderform-fields-username"/>\n</div>'),templates["neworder/order_usernames"]=_.template('<div class="form-group hidden fields" id="order_usernames">\n    <label class="control-label" for="field-orderform-fields-usernames"><%= label[\'usernames\'] %></label>\n    <textarea class="form-control w-full" name="OrderForm[usernames]" id="field-orderform-fields-usernames" cols="30" rows="10"><%= data[\'usernames\'] %></textarea>\n</div>'),templates["neworder/order_usernames_custom"]=_.template('<div class="form-group hidden fields" id="order_usernames_custom">\n    <label class="control-label" for="field-orderform-fields-usernames_custom"><%= label[\'usernames\'] %></label>\n    <textarea class="form-control" name="OrderForm[usernames_custom]" id="field-orderform-fields-usernames_custom" cols="30" rows="10"><%= data[\'usernames_custom\'] %></textarea>\n</div>'),templates["user/user_info_modal"]=_.template('\x3c!-- Modal --\x3e\n<div class="modal fade" id="userInfoModal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">\n    <div class="modal-dialog" role="document">\n        <form action="<%= action %>" id="userInfoForm" method="POST" class="modal-content">\n            <div class="modal-body">\n                <div id="userInfoError" class="error-summary alert alert-danger hidden"></div>\n                <div class="form-group">\n                    <label for="first_name"><%= labels[\'first_name\'] %></label>\n                    <input type="text" class="form-control" id="first_name" name="UpdateUserInfoFrom[first_name]" value="<%= values[\'first_name\'] %>">\n                </div>\n                <div class="form-group">\n                    <label for="last_name"><%= labels[\'last_name\'] %></label>\n                    <input type="text" class="form-control" id="last_name" name="UpdateUserInfoFrom[last_name]" value="<%= values[\'last_name\'] %>">\n                </div>\n\n                <input type="hidden" name="_csrf" value="<%= csrftoken %>">\n\n                <button type="submit" class="btn btn-primary" id="userInfoSubmit"><%= labels[\'submit_btn\'] %></button>\n            </div>\n        </form>\n    </div>\n</div>'),customModule.layouts={run:function(e){$(document).on("click",".alert .close",function(e){return e.preventDefault(),$(this).parents(".alert").hide(),!1}),$("form").submit(function(e){var t=$(this);if(t.hasClass("submitted"))return e.preventDefault(),!1;t.addClass("submitted")}),e.auth&&setInterval(function(){$.get("/check-auth",function(e){e.isAuth||location.reload()})},12e4)}},customModule.siteAddfunds={fieldsOptions:void 0,fieldsContainer:void 0,run:function(e){var t=this;t.fieldsContainer=$("form"),t.fieldOptions=e.fieldOptions,void 0!==e.options&&(void 0!==e.options.stripe&&t.initStripe(e.options.stripe),void 0!==e.options.stripePay&&t.initStripePay(e.options.stripePay),void 0!==e.options.midtrans&&t.initMidtrans(e.options.midtrans),void 0!==e.options.paywithpaytm&&t.initPaytm(e.options.paywithpaytm),void 0!==e.options.paytmimap&&t.initPaytm(e.options.paytmimap),void 0!==e.options.klikbca&&t.initKlikbca(e.options.klikbca),void 0!==e.options.kasikornbank&&t.initKlikbca(e.options.kasikornbank),void 0!==e.options.authorize&&t.initAuthorize(e.options.authorize),void 0!==e.options.buypayer&&t.initBuypayer(e.options.buypayer),void 0!==e.options.qiwi&&t.initQiwi(e.options.qiwi),void 0!==e.options.mastercard&&t.initMastercard(e.options.mastercard),void 0!==e.options.mastercardEu&&t.initMastercard(e.options.mastercardEu)),$(document).on("change","#method",function(){var e=$(this).val();t.updateFields(e)}),$("#method").trigger("change"),$("#amount").attr("step","0.01")},updateFields:function(e){var t=this;if($("button[type=submit]",t.fieldsContainer).show(),$(".fields",t.fieldsContainer).remove(),$("input,select",t.fieldsContainer).prop("disabled",!1),void 0!==t.fieldOptions&&void 0!==t.fieldOptions[e]&&t.fieldOptions[e]){var a=[],n=templates["addfunds/input"],o=templates["addfunds/hidden"];$.each(t.fieldOptions[e],function(e,t){void 0!==t&&null!=t&&t&&("input"==t.type&&a.push(n(t)),"hidden"==t.type&&a.push(o(t)))}),$(".form-group",t.fieldsContainer).last().after(a.join("\r\n"))}},initStripe:function(e){var t=this,a=StripeCheckout.configure($.extend({},!0,e.configure,{token:function(e){$("#field-token").val(e.id),$("#field-email").val(e.email),t.fieldsContainer.submit()}}));$("button",t.fieldsContainer).on("click",function(n){var o=$("#method").val();if(e.type!=o)return!0;var i=!1;if($.ajax({url:t.fieldsContainer.attr("action"),data:t.fieldsContainer.serialize(),async:!1,method:"POST",success:function(e){"success"==e.status&&(i=!0)}}),!i)return!0;var r=$.extend({},!0,e.open);return r.amount=100*$("#amount").val(),a.open(r),n.preventDefault(),!1}),$(window).on("popstate",function(){a.close()})},initStripePay:function(e){var t=this,a=$("button",t.fieldsContainer),n="payment-request-button",o=templates["addfunds/stripe_payment_request_btn"];a.after(o({id:n}));var i=$("#"+n),r=Stripe(e.configure.key),d=r.paymentRequest(e.payment_request);d.on("token",function(e){$("#field-token").val(e.token.id),$("#field-email").val(e.payerEmail),e.complete("success"),t.fieldsContainer.submit()});var s=r.elements(),l=s.create("paymentRequestButton",{paymentRequest:d,style:{paymentRequestButton:e.payment_request_button}});d.canMakePayment().then(function(e){e&&l.mount("#"+n)}),$(document).on("change","#method",function(t){var n=$(this).val();i.addClass("hidden"),a.removeClass("hidden"),n==e.type&&(a.addClass("hidden"),i.removeClass("hidden"))}),$(document).on("change","#amount",function(t){d.update({total:{label:e.payment_request.total.label,amount:100*$("#amount").val()}})})},initMidtrans:function(e){var t=this;$("button",t.fieldsContainer).on("click",function(a){var n=$("#method").val(),o=$("#amount").val(),i=!1;return e.type!=n||parseInt(o,10)!=o||(snap.show(),$.ajax({url:t.fieldsContainer.attr("action"),data:t.fieldsContainer.serialize()+"&save=true",async:!1,method:"POST",success:function(e){if("success"==e.status){var t=e.data.token;snap.pay(t)}else i=!0,snap.hide()}}),i?void 0:(a.preventDefault(),!1))})},initPaytm:function(e){var t=this,a=templates["addfunds/input"],n=templates["addfunds/description"],o=$("#method",t.fieldsContainer).parents(".form-group"),i=$("#amount",t.fieldsContainer).parents(".form-group"),r=$("label",i),d=$("button[type=submit]",t.fieldsContainer),s=r.html(),l=d.html();$(document).on("change","#method",function(i){var c=$(this).val();if(r.html(s),d.html(l),c==e.type){i.stopImmediatePropagation(),$(".fields",t.fieldsContainer).remove();var m=[];t.fieldOptions[c].description&&m.push(n($.extend({},!0,t.fieldOptions[c].description,{value:e.description}))),t.fieldOptions[c].transaction_id&&m.push(a(t.fieldOptions[c].transaction_id)),t.fieldOptions[c].amount&&r.html(t.fieldOptions[c].amount.label),t.fieldOptions[c].submit&&d.html(t.fieldOptions[c].submit.label),o.after(m.join("\r\n"))}})},initQiwi:function(e){var t=this,a=templates["addfunds/input"],n=templates["addfunds/description"],o=$("#method",t.fieldsContainer).parents(".form-group"),i=$("#amount",t.fieldsContainer).parents(".form-group"),r=$("label",i),d=$("button[type=submit]",t.fieldsContainer),s=r.html(),l=d.html();$(document).on("change","#method",function(i){var c=$(this).val();if(r.html(s),d.html(l),c==e.type){i.stopImmediatePropagation(),$(".fields",t.fieldsContainer).remove();var m=[];t.fieldOptions[c].instruction&&m.push(n($.extend({},!0,t.fieldOptions[c].instruction,{value:e.instruction}))),t.fieldOptions[c].transaction_id&&m.push(a(t.fieldOptions[c].transaction_id)),t.fieldOptions[c].amount&&r.html(t.fieldOptions[c].amount.label),t.fieldOptions[c].submit&&d.html(t.fieldOptions[c].submit.label),o.after(m.join("\r\n"))}})},initKlikbca:function(e){var t=this,a=templates["addfunds/description"],n=(templates["addfunds/disabled"],$("#method",t.fieldsContainer).parents(".form-group")),o=$("#amount",t.fieldsContainer).parents(".form-group"),i=$("button[type=submit]",t.fieldsContainer),r=$("input",o),d=$("select",n);$(document).on("change","#method",function(o){var s=$(this).val();if(s==e.type){o.stopImmediatePropagation();var l=[];t.fieldOptions[s].description&&e.description&&l.push(a($.extend({},!0,t.fieldOptions[s].description,{value:e.description}))),e.amount&&(r.val(e.amount),r.prop("disabled",!0),d.prop("disabled",!0),i.hide()),n.after(l.join("\r\n"))}})},initAuthorize:function(e){var t=this,a=e.configure,n=$("#amount"),o=$("#method"),i=$("button[type=submit]",t.fieldsContainer),r=$("<button />",a).hide();i.after(r),i.on("click",function(t){if(o.val()==e.type&&0<1*$.trim(n.val()))return t.stopImmediatePropagation(),r.trigger("click"),!1})},responseAuthorizeHandler:function(e){if("Error"===e.messages.resultCode)for(var t=0;t<e.messages.message.length;)alert(e.messages.message[t].code+": "+e.messages.message[t].text),t+=1;else $("#field-data_descriptor").val(e.opaqueData.dataDescriptor),$("#field-data_value").val(e.opaqueData.dataValue),$("form").submit()},initBuypayer:function(e){e.content&&window.open(e.content,"_top")},initMastercard:function(e){var t=this;$("button",t.fieldsContainer).on("click",function(a){var n=$("#method").val();if(e.type!=n)return!0;var o=!1,i=null,r=null,d=t.fieldsContainer.serializeArray();return d.push({name:"save",value:1}),$.ajax({url:t.fieldsContainer.attr("action"),data:$.param(d),async:!1,method:"POST",success:function(e){"success"==e.status&&(o=!0,i=e.data.payment_id,r=e.data.session_id)}}),!o||(e.configure.order.amount=function(){return $("#amount").val()},e.configure.order.id=i,e.configure.session.id=r,e.configure.callback.error=function(e){console.log(JSON.stringify(e))},e.configure.callback.cancel=function(e){console.log("Payment cancelled")},Checkout.configure(e.configure),Checkout.showLightbox(),!1)})}};var responseAuthorizeHandler=customModule.siteAddfunds.responseAuthorizeHandler;customModule.api={run:function(e){$("#service_type").length||$('div[id^="type_"]').show(),$("#service_type").change(function(){$("div[id^='type_']").hide();var e=$("#service_type").val();$("#type_"+e).show()}),$("#service_type").trigger("change")}},customModule.siteOrder={run:function(e){document.forms.sendform.submit()}},customModule.siteHistory={run:function(e){$("#setRefill").on("show.bs.modal",function(e){$("#refill_loader").show(),$("#refill_body").html("");var t=$(this),a=$("form",t);$('input[name="id"]',a).val($(e.relatedTarget).data("href")),$.post(a.attr("action"),a.serialize(),function(e){if("success"==e.status)return location.reload(),!1;"error"==e.status&&($("#refill_loader").hide(),$("#refill_body").html(e.error))})})}},customModule.siteOrder={fieldsOptions:void 0,fieldsContainer:void 0,services:[],fields:[],maxQuantity:0,run:function(e){var t=this;t.services=$.extend({},!0,e.services),t.fields=$.extend({},!0,e.fields),t.currencyOptions=$.extend({},!0,e.currency),t.format=$.extend({},!0,e.format),t.fieldsContainer=$("#fields"),t.fieldOptions=e.fieldOptions,$(document).on("change","#orderform-category",function(){var e=$(this).val();t.updateServices(e),$("#orderform-service").trigger("change")}),$(document).on("change","#orderform-service",function(){var e=$(this),a=$("option:selected",e).data("type");t.updateFields(a,!0),t.updateDescription()}),$(document).on("keyup",".counter",function(){var e=$(this),a=$("input, textarea",$("#order_"+e.data("related")+".fields"));a.length?(value=e.val(),a.val(value.split("\n").length)):a.val(0),t.updateCharge()}),$(document).on("change","#field-orderform-fields-check",function(){var e=$(this),a=e.attr("id"),n=$('.depend-fields[data-depend="'+a+'"]');e.prop("checked")?n.removeClass("hidden"):n.addClass("hidden"),t.updateTotalQuantity()}),$(document).on("keyup","#field-orderform-fields-quantity",function(){t.updateCharge()}),$(document).on("keyup","#field-orderform-fields-quantity, #field-orderform-fields-runs",function(){t.updateTotalQuantity()}),$(document).on("click",".clear-datetime",function(){var e=$(this).data("rel");$(e).val("")}),$("#orderform-category").length?$("#orderform-category").trigger("change"):t.updateServices(),t.initFields(),function(){var e=$("#orderform-service"),a=$("option:selected",e).data("type");t.updateFields(a,!1),t.updateCharge(),t.updateDescription(),$("#field-orderform-fields-check").trigger("change")}()},getMaxQuantityValue:function(){var e=this,t=e.getCurrentServicePrice();return 0>=t?Number.MAX_SAFE_INTEGER:parseInt(Number.MAX_SAFE_INTEGER-1/t)},preparePrice:function(e){var t=this,a=t.format,n=a.min;e=$.trim(e.toString().replace(",","."));var o=e.split(".");return void 0!==o[1]&&(o[1]=o[1].replace(/0+$/g,""),o[1].length>n&&(n=a.max<o[1].length?a.max:o[1].length)),e=parseFloat(e),e=e.toFixed(n),1e3<=e&&(e=e.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1"+a.thousands)),e=e.replace(/\.(\d+)$/g,a.delimiter+"$1"),e=t.currencyOptions.template.replace("{{value}}",e)},getCurrentServicePrice:function(){var e=this,t=$("#orderform-service"),a=e.services[t.val()];if(!a)return 0;var n=a.orig_price;return parseFloat(n)},getCurrentServiceType:function(){var e=this,t=$("#orderform-service"),a=e.services[t.val()];return a?a.type:0},updateTotalQuantity:function(){var e=this,t=$("#field-orderform-fields-quantity"),a=$("#field-orderform-fields-runs"),n=$("#field-orderform-fields-total-quantity"),o=0;o=1*t.val()*(1*a.val()),n.val(o),e.updateCharge()},updateCharge:function(){var e=this,t=$("#charge"),a=t.parent(".form-group"),n=$("#field-orderform-fields-quantity"),o=$("#orderform-service"),i=e.getMaxQuantityValue();if(a.show(),t.val(e.preparePrice(0)),e.services[o.val()]){var r=e.getCurrentServicePrice(),d=1*e.getCurrentServiceType();if(10==d||14==d)return void t.val(e.preparePrice(r));if(100==d)return void a.hide();12==d&&$("#field-orderform-fields-check").prop("checked")&&(n=$("#field-orderform-fields-total-quantity"));var s=$.trim(n.val());if(!s||""==s||!s.length||isNaN(s)||!s.match(/^\d+$/gi))return void t.val("");if(s=parseInt(s),isNaN(s))return void t.val("");i<s&&(s=i),r*=s,r/=1e3,t.val(e.preparePrice(r))}},updateServices:function(e){var t=this,a=$("#orderform-service"),n=a.parent(".form-group"),o=[],i=void 0;void 0!==t.fieldOptions&&void 0!==t.fieldOptions.data&&void 0!==t.fieldOptions.data.service&&(i=t.fieldOptions.data.service),n.addClass("hidden"),a.html(""),$.each(t.services,function(t,a){void 0!==e&&e!=a.cid||o.push(a)}),o.sort(function(e,t){var a=parseInt(e.position),n=parseInt(t.position);return a<n?-1:a>n?1:0});var r=void 0;$.each(o,function(e,t){
r=$("<option></option>").attr("data-type",t.type).attr("value",t.id).text(t.name),i==t.id&&r.attr("selected","selected"),a.append(r)}),$("option",a).length&&n.removeClass("hidden")},updateFields:function(e,t){var a=this,n=$('.fields input[type="text"], .fields textarea, .depend-fields input[type="text"], .depend-fields textarea');n.prop("disabled",!1),n.removeAttr("data-related"),n.removeClass("counter"),$(".fields, .depend-fields").addClass("hidden"),void 0!==a.fields[e]&&($.each(a.fields[e],function(e,t){var a=$("#order_"+t.name+".fields"),n=$("input, textarea",a);if(void 0!==t.disabled&&t.disabled){n.prop("disabled",!0);$("input, textarea",$("#order_"+t.related+".fields")).attr("data-related",t.name).addClass("counter").trigger("keyup")}a.removeClass("hidden"),a.hasClass("has-depends")&&n.trigger("change")}),void 0!==t&&t&&(n.val(""),$('.fields input[type="checkbox"]').prop("checked",!1)),a.updateCharge(),a.initDatetime())},updateDescription:function(){var e=this,t=$("#orderform-service"),a=e.services[t.val()],n=$("#service_description"),o=$("div",n);o.html(""),n.addClass("hidden"),"string"==typeof a.description&&a.description.length&&(o.html(a.description),n.removeClass("hidden"))},initFields:function(){var e=this,t=e.fieldOptions.fields,a="";e.fieldsContainer.html("");var n=[];$.each(t,function(t,o){"function"==typeof(a=templates["neworder/order_"+o])&&n.push(a(e.fieldOptions))}),e.fieldsContainer.html(n.join("\r\n")),e.initDatetime()},initDatetime:function(){$(".datetime").length&&$(".datetime").datetimepicker({format:"DD/MM/YYYY",minDate:new Date,icons:{previous:"fa fa-chevron-left",next:"fa fa-chevron-right"}})}},customModule.siteTickets={run:function(e){$("#ticketsend").submit(function(t){t.preventDefault();var a=$("#send"),n=$(this);return!a.hasClass("active")&&(a.addClass("active"),$.post(e.createTicketUrl,n.serialize(),function(e){a.removeClass("active"),"success"==e.status&&($(".ticket-danger").hide(),window.location="/tickets"),"error"==e.status&&($(".ticket-danger div").html(e.error),$(".ticket-danger").show())}),!1)})}},customModule.userInfoModal={run:function(e){this.init(e),$(document).on("click","#userInfoSubmit",function(e){e.preventDefault();var t=$(this),a=$("#userInfoForm"),n=$("#userInfoError",a);return n.addClass("hidden"),console.log(a.serialize()),custom.sendFrom(t,a,{data:a.serialize(),callback:function(e){"success"==e.status&&window.location.reload(),"error"==e.status&&(n.removeClass("hidden"),n.html(e.error))}}),!1})},init:function(e){var t=templates["user/user_info_modal"];$("body").append(t(e)),$("#userInfoModal").modal("show")}};